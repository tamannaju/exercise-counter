{% extends "base.html" %}

{% block title %}Exercise Counter - Live Mode{% endblock %}
{% block header_subtitle %}Live webcam mode • real-time rep counting{% endblock %}

{% block header_actions %}
  <a class="btn btn-primary" href="/">← Back to Video Upload Mode</a>
{% endblock %}

{% block footer_tip %}Tips: stable camera • full body in frame • bright environment{% endblock %}

{% block content %}
  <section class="hero">
    <div class="hero-top">
      <div>
        <h2 class="hero-title">Live Webcam Mode</h2>
        <p class="hero-sub">
          Select an exercise, start the webcam, and watch the count update in real time.
          Keep your full body visible and the camera stable for best accuracy.
        </p>
      </div>

      <div class="status-pill" id="statusPill">
        <span class="dot" id="statusDot"></span>
        <span id="statusText">Idle</span>
      </div>
    </div>
  </section>

  <section class="grid grid-live">
    <div class="card">
      <h2>Controls</h2>
      <p class="muted" style="margin-top:0;">Choose exercise first, then start the webcam feed.</p>

      <label for="exerciseSelect">Select Exercise</label>
      <select id="exerciseSelect">
        <option value="crunch">Crunch</option>
        <option value="squat">Squat</option>
        <option value="pushup">Push-up</option>
        <option value="pullup">Pull-up</option>
      </select>

      <div class="row">
        <button id="startBtn" class="btn-start" type="button">Start Webcam</button>
        <button id="stopBtn" class="btn-stop" type="button" disabled>Stop Webcam</button>
      </div>

      <div class="kpi">
        <div>
          <div class="lbl">Current Count</div>
          <div class="num" id="countDisplay">0</div>
        </div>
        <div class="mini">Pro tip: good lighting helps</div>
      </div>

      <div class="instructions">
        <h3>Quick Instructions</h3>
        <ol>
          <li>Select an exercise type</li>
          <li>Click Start Webcam</li>
          <li>Make sure your full body is visible</li>
          <li>Perform reps and watch the counter</li>
          <li>Click Stop when finished</li>
        </ol>
      </div>
    </div>

    <div class="card">
      <h2>Live Feed</h2>
      <div class="video-wrap">
        <div class="video-title">
          <span class="muted">Webcam stream preview</span>
          <span class="badge" id="feedBadge">Not streaming</span>
        </div>

        <img id="videoFeed" alt="Webcam feed will appear here">
        <div class="mini" style="margin-top:10px;">
          If the feed doesn’t start, check browser camera permissions and try again.
        </div>
      </div>
    </div>
  </section>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/live.js') }}"></script>
{% endblock %}